# <a name="how-the-office-javascript-api-documentation-is-generated"></a><span data-ttu-id="7b41a-101">Wie die JavaScript-API-Dokumentation für Office generiert wird</span><span class="sxs-lookup"><span data-stu-id="7b41a-101">How the Office JavaScript API documentation is generated</span></span>

<span data-ttu-id="7b41a-102">Die Office-JavaScript-Referenzdokumentationsseiten werden aus Typdefinitionsdateien und Beispielausschnitten generiert.</span><span class="sxs-lookup"><span data-stu-id="7b41a-102">The Office JavaScript reference documentation pages are generated from type definition files and example snippets.</span></span> <span data-ttu-id="7b41a-103">Dieser Prozess verwendet eine Mischung aus Open Source-Tools und repositoryspezifischen Skripts.</span><span class="sxs-lookup"><span data-stu-id="7b41a-103">This process uses a blend of open source tools and repository-specific scripts.</span></span> <span data-ttu-id="7b41a-104">Dieses Dokument soll die Prozesse dieses Repositorys transparent machen, damit die Community von diesen Inhalten besser profitieren und zu diesen beitragen kann.</span><span class="sxs-lookup"><span data-stu-id="7b41a-104">This document aims to make the processes of this repository transparent so the community can better benefit from and contribute to this content.</span></span>

## <a name="content-sources"></a><span data-ttu-id="7b41a-105">Inhaltsquellen</span><span class="sxs-lookup"><span data-stu-id="7b41a-105">Content sources</span></span>

<span data-ttu-id="7b41a-106">Zwei Inhaltstypen werden kombiniert, um die Office-JS-Referenzdokumentation zu erstellen: Typdefinitionen und Codeausschnitte.</span><span class="sxs-lookup"><span data-stu-id="7b41a-106">Two types of content are combined to create the Office-JS reference documentation: type definitions and code snippets.</span></span> <span data-ttu-id="7b41a-107">Diese stellen eine vollständige API-Abdeckung sicher und geben kleine Inlinecodebeispiele.</span><span class="sxs-lookup"><span data-stu-id="7b41a-107">These ensure complete API coverage and give small, inline code samples.</span></span>

### <a name="type-definition-files"></a><span data-ttu-id="7b41a-108">Typdefinitionsdateien</span><span class="sxs-lookup"><span data-stu-id="7b41a-108">Type definition files</span></span>

<span data-ttu-id="7b41a-109">Die Typdefinitionsdateien auf ["Definitely Typed"](https://github.com/DefinitelyTyped/DefinitelyTyped) sind die einzige Wahrheitsquelle für die Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="7b41a-109">The type definition files on [Definitely Typed](https://github.com/DefinitelyTyped/DefinitelyTyped) are the single source of truth for the documentation.</span></span> <span data-ttu-id="7b41a-110">Jedes Office-Add-In, das TypeScript verwendet, kompiliert mithilfe dieser Typdefinitionsdateien.</span><span class="sxs-lookup"><span data-stu-id="7b41a-110">Any Office Add-in that uses TypeScript compiles by using these type definition files.</span></span> <span data-ttu-id="7b41a-111">Diese bieten JavaScript- und TypeScript-Entwicklern IntelliSense Funktionen.</span><span class="sxs-lookup"><span data-stu-id="7b41a-111">These also give JavaScript and TypeScript developers IntelliSense capabilities.</span></span> <span data-ttu-id="7b41a-112">Durch erstellen der Referenzdokumentation aus diesen Definitionen stellen wir genauere Informationen zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="7b41a-112">By building the reference documentation from these definitions, we provide more accurate information.</span></span>

<span data-ttu-id="7b41a-113">Es gibt vier relevante d.ts-Dateien, die Quellinhalte für verschiedene Unterabschnitte der Dokumente bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="7b41a-113">There are four relevant d.ts files that provide source content for different subsections of the docs.</span></span>

- <span data-ttu-id="7b41a-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (Die Releasedefinitionen.)</span><span class="sxs-lookup"><span data-stu-id="7b41a-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (The Release definitions.)</span></span>
  - [<span data-ttu-id="7b41a-115">Excel (Release)</span><span class="sxs-lookup"><span data-stu-id="7b41a-115">Excel (Release)</span></span>](https://docs.microsoft.com/javascript/api/excel_release)
  - [<span data-ttu-id="7b41a-116">OneNote</span><span class="sxs-lookup"><span data-stu-id="7b41a-116">OneNote</span></span>](https://docs.microsoft.com/javascript/api/onenote)
  - [<span data-ttu-id="7b41a-117">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="7b41a-117">PowerPoint</span></span>](https://docs.microsoft.com/javascript/api/powerpoint)
  - [<span data-ttu-id="7b41a-118">Visio</span><span class="sxs-lookup"><span data-stu-id="7b41a-118">Visio</span></span>](https://docs.microsoft.com/javascript/api/visio)
  - [<span data-ttu-id="7b41a-119">Word (Release)</span><span class="sxs-lookup"><span data-stu-id="7b41a-119">Word (Release)</span></span>](https://docs.microsoft.com/javascript/api/word_release)
  - [<span data-ttu-id="7b41a-120">Unterabschnitt "OfficeExtensions" der allgemeinen API</span><span class="sxs-lookup"><span data-stu-id="7b41a-120">OfficeExtensions subsection of the Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="7b41a-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (Die Vorschaudefinitionen.)</span><span class="sxs-lookup"><span data-stu-id="7b41a-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (The Preview definitions.)</span></span>
  - [<span data-ttu-id="7b41a-122">Excel (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="7b41a-122">Excel (Preview)</span></span>](https://docs.microsoft.com/javascript/api/excel)
  - [<span data-ttu-id="7b41a-123">Outlook (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="7b41a-123">Outlook (Preview)</span></span>](https://docs.microsoft.com/javascript/api/outlook)
  - [<span data-ttu-id="7b41a-124">Word (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="7b41a-124">Word (Preview)</span></span>](https://docs.microsoft.com/javascript/api/word)
  - [<span data-ttu-id="7b41a-125">Allgemeine API</span><span class="sxs-lookup"><span data-stu-id="7b41a-125">Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="7b41a-126">[custom-functions-runtime/index.d.ts (Die](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) Excel Custom Functions-Laufzeitdefinitionen).)</span><span class="sxs-lookup"><span data-stu-id="7b41a-126">[custom-functions-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (The Excel Custom Functions runtime definitions.)</span></span>
  - [<span data-ttu-id="7b41a-127">Benutzerdefinierte Funktionen</span><span class="sxs-lookup"><span data-stu-id="7b41a-127">Custom Functions</span></span>](https://docs.microsoft.com/javascript/api/custom-functions-runtime)
- <span data-ttu-id="7b41a-128">[office-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (Die Office-Laufzeitdefinitionen für die Plattform für benutzerdefinierte Funktionen.)</span><span class="sxs-lookup"><span data-stu-id="7b41a-128">[office-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (The office runtime definitions for the Custom Functions platform.)</span></span>
  - [<span data-ttu-id="7b41a-129">Office Runtime</span><span class="sxs-lookup"><span data-stu-id="7b41a-129">Office Runtime</span></span>](https://docs.microsoft.com/javascript/api/office-runtime)

<span data-ttu-id="7b41a-130">Ältere Versionen der APIs verfügen über eigene d.ts-Dateien.</span><span class="sxs-lookup"><span data-stu-id="7b41a-130">Older versions of the APIs have their own d.ts files.</span></span> <span data-ttu-id="7b41a-131">Diese werden beibehalten, wenn ein neuer API-Anforderungssatz veröffentlicht wird.</span><span class="sxs-lookup"><span data-stu-id="7b41a-131">These are preserved when a new API requirement set is released.</span></span> <span data-ttu-id="7b41a-132">Sie können auch mit dem Tool ["Versionsentferner" generiert werden.](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts)</span><span class="sxs-lookup"><span data-stu-id="7b41a-132">They can also be generated using the [Version Remover tool](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span></span> <span data-ttu-id="7b41a-133">Diese alten d.ts-Dateien werden so beibehalten, dass das ursprüngliche Verhalten weiterhin dokumentiert wird, wenn APIs gepatcht oder geändert werden.</span><span class="sxs-lookup"><span data-stu-id="7b41a-133">These old d.ts files are maintained so that in the event APIs are patched or altered, the original behavior is still documented.</span></span> <span data-ttu-id="7b41a-134">Dies ist hilfreich, wenn Sie eine ältere Version der API als Ziel verwenden müssen.</span><span class="sxs-lookup"><span data-stu-id="7b41a-134">This is useful if you have to target an older version of the API.</span></span>

#### <a name="testing-type-definition-file-changes"></a><span data-ttu-id="7b41a-135">Testen von Änderungen der Typdefinitionsdatei</span><span class="sxs-lookup"><span data-stu-id="7b41a-135">Testing type definition file changes</span></span>

<span data-ttu-id="7b41a-136">Alle Dokumentationsänderungen für die Office-JavaScript-API werden durch Bearbeiten der vier oben genannten d.ts-Dateien vorgenommen.</span><span class="sxs-lookup"><span data-stu-id="7b41a-136">Any documentation changes for the Office JavaScript API are done by editing the four d.ts files mentioned above.</span></span> <span data-ttu-id="7b41a-137">Sie können jedoch eine Änderung testen, bevor Sie eine PR an DefinitelyTyped übermitteln (wenn Sie z. B. testen müssen, wie Ihre Formatierung in Markdown übersetzt wird), indem Sie die entsprechende Datei in [generate-docs/script-inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) bearbeiten und [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd)ausführen.</span><span class="sxs-lookup"><span data-stu-id="7b41a-137">However, you can test a change before submitting a PR to DefinitelyTyped (if you need to, for example, test how your formatting will translate into markdown) by editing the corresponding file in [generate-docs/script-inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) and running [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd).</span></span> <span data-ttu-id="7b41a-138">Wenn Sie dazu aufgefordert werden, wählen Sie die Option "Lokale Dateien" aus.</span><span class="sxs-lookup"><span data-stu-id="7b41a-138">When prompted, select the "Local files" option.</span></span>

<span data-ttu-id="7b41a-139">Das Pushen von Änderungen an einen Remotezweig dieses Repositorys bewirkt, dass die docs.microsoft.com A0 einen Testzweig aufbaut.</span><span class="sxs-lookup"><span data-stu-id="7b41a-139">Pushing changes to a remote branch of this repo causes the docs.microsoft.com platform to build a test branch.</span></span> <span data-ttu-id="7b41a-140">Diese Verzweigung wird auf einem review.docs.microsoft.com gerendert, auf den nur interne Mitarbeiter von Microsoft zugriffen können.</span><span class="sxs-lookup"><span data-stu-id="7b41a-140">This branch is rendered on review.docs.microsoft.com, which is only accessible by internal Microsoft personnel.</span></span> <span data-ttu-id="7b41a-141">Jeder, der Ihre PR überprüft, überprüft die Überprüfungswebsite auf Genauigkeit.</span><span class="sxs-lookup"><span data-stu-id="7b41a-141">Anyone reviewing your PR will check the review site for accuracy.</span></span>

### <a name="code-snippets"></a><span data-ttu-id="7b41a-142">Codeausschnitte</span><span class="sxs-lookup"><span data-stu-id="7b41a-142">Code snippets</span></span>

<span data-ttu-id="7b41a-143">Codebeispielausschnitte werden den Referenzseiten aus zwei Quellen hinzugefügt:</span><span class="sxs-lookup"><span data-stu-id="7b41a-143">Code example snippets are added to the reference pages from two sources:</span></span>

- [<span data-ttu-id="7b41a-144">Script Lab Samples</span><span class="sxs-lookup"><span data-stu-id="7b41a-144">Script Lab Samples</span></span>](https://github.com/OfficeDev/office-js-snippets)
- [<span data-ttu-id="7b41a-145">Lokale Codeausschnitte</span><span class="sxs-lookup"><span data-stu-id="7b41a-145">Local Code Snippets</span></span>](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/code-snippets)

<span data-ttu-id="7b41a-146">Die lokalen Codeausschnitte befinden sich in hostspezifischen Yaml-Dateien.</span><span class="sxs-lookup"><span data-stu-id="7b41a-146">The local snippets are in host-specific yaml files.</span></span> <span data-ttu-id="7b41a-147">Der Inhalt ist nach Klasse und Feld organisiert, sodass er dem entsprechenden Ort auf einer Referenzseite zugeordnet werden kann.</span><span class="sxs-lookup"><span data-stu-id="7b41a-147">Their content is organized by class and field, so it can be mapped to the appropriate place in a reference page.</span></span> <span data-ttu-id="7b41a-148">Die Sprache des Codeausschnitts (JavaScript oder TypeScript) wird durch die Verwendung von await-Anweisungen abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="7b41a-148">The language of the snippet (JavaScript or TypeScript) is inferred by the use of await statements.</span></span>

<span data-ttu-id="7b41a-149">Die Script Lab-Codeausschnitte werden aus Arbeitsbeispielen entnommen.</span><span class="sxs-lookup"><span data-stu-id="7b41a-149">The Script Lab snippets are pulled from working samples.</span></span> <span data-ttu-id="7b41a-150">Derzeit werden Excel-, Outlook-, PowerPoint- und Word-Beispiele so zugeordnet, dass sie über Zuordnungsdateien auf [Dokumentabschnitte verweisen.](https://github.com/OfficeDev/office-js-snippets/tree/prod/snippet-extractor-metadata)</span><span class="sxs-lookup"><span data-stu-id="7b41a-150">Currently, Excel, Outlook, PowerPoint, and Word samples are mapped to reference document sections through [mapping files](https://github.com/OfficeDev/office-js-snippets/tree/prod/snippet-extractor-metadata).</span></span> <span data-ttu-id="7b41a-151">Diese entsprechen einzelnen Beispielmethoden Eigenschaften oder Methoden in der API.</span><span class="sxs-lookup"><span data-stu-id="7b41a-151">These match individual sample methods to properties or methods in the API.</span></span> <span data-ttu-id="7b41a-152">Wenn das Office-js-snippets-Repository ausgeführt wird, wird eine Yaml-Datei mit allen zugeordneten `yarn start` Codeausschnitten [](https://github.com/OfficeDev/office-js-snippets/blob/prod/snippet-extractor-output/snippets.yaml) erstellt.</span><span class="sxs-lookup"><span data-stu-id="7b41a-152">When the office-js-snippets repository's `yarn start` runs, [a yaml file](https://github.com/OfficeDev/office-js-snippets/blob/prod/snippet-extractor-output/snippets.yaml) containing all the mapped snippets is created.</span></span> <span data-ttu-id="7b41a-153">Diese Yaml-Datei ist die Eingabe in das Referenzdokumentationstool.</span><span class="sxs-lookup"><span data-stu-id="7b41a-153">This yaml file is the input into the reference documentation tooling.</span></span>

## <a name="tooling-pipeline"></a><span data-ttu-id="7b41a-154">Toolpipeline</span><span class="sxs-lookup"><span data-stu-id="7b41a-154">Tooling pipeline</span></span>

![Abbildung des Steuerungsflusses von "Definitely Typed" zum Präprozessor, API Extractor, Midprocessor, API Documenter und zum Postprocessor.](ToolingPipeline.png)

<span data-ttu-id="7b41a-156">Zwischen den Inhaltsquellen und den endgültigen Seiten durchgeht der Dokumentationsinhalt fünf Toolschritte:</span><span class="sxs-lookup"><span data-stu-id="7b41a-156">Between the content sources and the final pages, the documentation content goes through five tooling steps:</span></span>

1. [<span data-ttu-id="7b41a-157">Präprozessorskript</span><span class="sxs-lookup"><span data-stu-id="7b41a-157">Preprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/preprocessor.ts)
1. [<span data-ttu-id="7b41a-158">API Extractor</span><span class="sxs-lookup"><span data-stu-id="7b41a-158">API Extractor</span></span>](https://api-extractor.com/)
1. [<span data-ttu-id="7b41a-159">Midprocessorskript</span><span class="sxs-lookup"><span data-stu-id="7b41a-159">Midprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/midprocessor.ts)
1. [<span data-ttu-id="7b41a-160">API Documenter</span><span class="sxs-lookup"><span data-stu-id="7b41a-160">API Documenter</span></span>](https://github.com/microsoft/rushstack/blob/master/apps/api-documenter/README.md)
1. [<span data-ttu-id="7b41a-161">Postprocessorskript</span><span class="sxs-lookup"><span data-stu-id="7b41a-161">Postprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/postprocessor.ts)

<span data-ttu-id="7b41a-162">Der Präprozessor übernimmt die d.ts-Dateien und teilt sie in hostspezifische Abschnitte auf.</span><span class="sxs-lookup"><span data-stu-id="7b41a-162">The preprocessor takes the d.ts files and splits them into host-specific sections.</span></span> <span data-ttu-id="7b41a-163">Sie führt alle Bereinigungen durch, die für die nachfolgenden Tools erforderlich sind, um die Daten ordnungsgemäß zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="7b41a-163">It performs any cleanup necessary for the subsequent tools to properly process the data.</span></span>

<span data-ttu-id="7b41a-164">Der API Extractor konvertiert die d.ts-Dateien in JSON-Daten.</span><span class="sxs-lookup"><span data-stu-id="7b41a-164">API Extractor converts the d.ts files into JSON data.</span></span> <span data-ttu-id="7b41a-165">Dadurch werden alle Typdaten tokenisiert, was eine einfachere Analyse ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="7b41a-165">This tokenizes all the type data, allowing for easier parsing.</span></span>

<span data-ttu-id="7b41a-166">Der Midprocessor ruft die Codeausschnitte ab und paart sie mit den richtigen Hosts und bereinigt die Verknüpfung zwischen Outlook- und allgemeinen API-Objekten.</span><span class="sxs-lookup"><span data-stu-id="7b41a-166">The midprocessor retrieves the code snippets and pairs them with the proper hosts, and cleans up the crosslinking between Outlook and Common API objects.</span></span>

<span data-ttu-id="7b41a-167">API Documenter konvertiert die JSON-Daten in YML-Dateien.</span><span class="sxs-lookup"><span data-stu-id="7b41a-167">API Documenter converts the JSON data into .yml files.</span></span> <span data-ttu-id="7b41a-168">Die .yml-Dateien werden vom Open Publishing System, das unsere Dokumente in der Datei veröffentlicht, in Markdown docs.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="7b41a-168">The .yml files are converted to markdown by the Open Publishing System that publishes our docs to docs.microsoft.com.</span></span> <span data-ttu-id="7b41a-169">DER API Documenter enthält auch eine Office-spezifische Erweiterung, die unsere Codeausschnitte einf?en.</span><span class="sxs-lookup"><span data-stu-id="7b41a-169">API Documenter also contains an Office-specific extension that inserts our code snippets.</span></span>

<span data-ttu-id="7b41a-170">Der Postprozessor bereinigt das Inhaltsverzeichnis und verschiebt die YML-Dateien in den [Veröffentlichungsordner.](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen)</span><span class="sxs-lookup"><span data-stu-id="7b41a-170">The postprocessor cleans up the table of contents and moves the .yml files into the [publishing folder](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span></span>

<span data-ttu-id="7b41a-171">Alle fünf dieser Schritte werden ausgeführt, wenn [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="7b41a-171">All five of these steps are performed when [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) is run.</span></span> <span data-ttu-id="7b41a-172">Dieses Skript verarbeitet auch die Knotenmodulinstallation, bereinigt alte Dateisätze und Versionstypdefinitionsdateien für jeden Anforderungssatz.</span><span class="sxs-lookup"><span data-stu-id="7b41a-172">That script also handles node module installation, cleans out old file sets, and versions Type Definition files for each requirement set.</span></span>

# <a name="how-the-office-javascript-api-documentation-is-generated"></a><span data-ttu-id="34400-101">So wird die Office-JavaScript-API-Dokumentation generiert</span><span class="sxs-lookup"><span data-stu-id="34400-101">How the Office JavaScript API documentation is generated</span></span>

<span data-ttu-id="34400-102">Die Office JavaScript-Referenz Dokumentationsseiten werden aus typdefinitions Dateien und Beispielcode Ausschnitten generiert.</span><span class="sxs-lookup"><span data-stu-id="34400-102">The Office JavaScript reference documentation pages are generated from type definition files and example snippets.</span></span> <span data-ttu-id="34400-103">Dieser Prozess verwendet eine Mischung aus Open Source-Tools und Repository-spezifischen Skripts.</span><span class="sxs-lookup"><span data-stu-id="34400-103">This process uses a blend of open source tools and repository-specific scripts.</span></span> <span data-ttu-id="34400-104">Dieses Dokument zielt darauf ab, die Prozesse in diesem Repository transparent zu machen, damit die Community besser von diesen Inhalten profitieren und dazu beitragen kann.</span><span class="sxs-lookup"><span data-stu-id="34400-104">This document aims to make the processes of this repository transparent so the community can better benefit from and contribute to this content.</span></span>

## <a name="content-sources"></a><span data-ttu-id="34400-105">Inhaltsquellen</span><span class="sxs-lookup"><span data-stu-id="34400-105">Content sources</span></span>

<span data-ttu-id="34400-106">Zwei Arten von Inhalten werden zusammengefasst, um die Office-js-Referenzdokumentation zu erstellen: Typdefinitionen und Codeausschnitte.</span><span class="sxs-lookup"><span data-stu-id="34400-106">Two types of content are combined to create the Office-JS reference documentation: type definitions and code snippets.</span></span> <span data-ttu-id="34400-107">Dadurch wird eine vollständige API-Abdeckung gewährleistet und kleine Inlinecode Beispiele gegeben.</span><span class="sxs-lookup"><span data-stu-id="34400-107">These ensure complete API coverage and give small, inline code samples.</span></span>

### <a name="type-definition-files"></a><span data-ttu-id="34400-108">Typen Definitionsdateien</span><span class="sxs-lookup"><span data-stu-id="34400-108">Type definition files</span></span>

<span data-ttu-id="34400-109">Die typdefinitions Dateien auf [eindeutig typisiert](https://github.com/DefinitelyTyped/DefinitelyTyped) sind die einzige Quelle der Wahrheit für die Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="34400-109">The type definition files on [Definitely Typed](https://github.com/DefinitelyTyped/DefinitelyTyped) are the single source of truth for the documentation.</span></span> <span data-ttu-id="34400-110">Alle Office-Add-in, bei denen die Ausführung von schreiben mithilfe dieser typdefinitions Dateien kompiliert wird.</span><span class="sxs-lookup"><span data-stu-id="34400-110">Any Office Add-in that uses TypeScript compiles by using these type definition files.</span></span> <span data-ttu-id="34400-111">Diese geben auch JavaScript-und Scripting-Entwickler-IntelliSense-Funktionen.</span><span class="sxs-lookup"><span data-stu-id="34400-111">These also give JavaScript and TypeScript developers IntelliSense capabilities.</span></span> <span data-ttu-id="34400-112">Durch die Erstellung der Referenzdokumentation aus diesen Definitionen werden genauere Informationen bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="34400-112">By building the reference documentation from these definitions, we provide more accurate information.</span></span>

<span data-ttu-id="34400-113">Es gibt vier relevante d. TS-Dateien, die Quellinhalte für verschiedene Unterabschnitte der Dokumente bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="34400-113">There are four relevant d.ts files that provide source content for different subsections of the docs.</span></span>

- <span data-ttu-id="34400-114">[Office-js/Index. d. TS](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (die Veröffentlichungs Definitionen)</span><span class="sxs-lookup"><span data-stu-id="34400-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (The Release definitions.)</span></span>
  - [<span data-ttu-id="34400-115">Excel (Version)</span><span class="sxs-lookup"><span data-stu-id="34400-115">Excel (Release)</span></span>](https://docs.microsoft.com/javascript/api/excel_release)
  - [<span data-ttu-id="34400-116">OneNote</span><span class="sxs-lookup"><span data-stu-id="34400-116">OneNote</span></span>](https://docs.microsoft.com/javascript/api/onenote)
  - [<span data-ttu-id="34400-117">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="34400-117">PowerPoint</span></span>](https://docs.microsoft.com/javascript/api/powerpoint)
  - [<span data-ttu-id="34400-118">Visio</span><span class="sxs-lookup"><span data-stu-id="34400-118">Visio</span></span>](https://docs.microsoft.com/javascript/api/visio)
  - [<span data-ttu-id="34400-119">Word (Version)</span><span class="sxs-lookup"><span data-stu-id="34400-119">Word (Release)</span></span>](https://docs.microsoft.com/javascript/api/word_release)
  - [<span data-ttu-id="34400-120">OfficeExtensions-unter Abschnitt der allgemeinen API</span><span class="sxs-lookup"><span data-stu-id="34400-120">OfficeExtensions subsection of the Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="34400-121">[Office-js-Preview/Index. d. TS](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (die Vorschau Definitionen.)</span><span class="sxs-lookup"><span data-stu-id="34400-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (The Preview definitions.)</span></span>
  - [<span data-ttu-id="34400-122">Excel (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="34400-122">Excel (Preview)</span></span>](https://docs.microsoft.com/javascript/api/excel)
  - [<span data-ttu-id="34400-123">Outlook (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="34400-123">Outlook (Preview)</span></span>](https://docs.microsoft.com/javascript/api/outlook)
  - [<span data-ttu-id="34400-124">Word (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="34400-124">Word (Preview)</span></span>](https://docs.microsoft.com/javascript/api/word)
  - [<span data-ttu-id="34400-125">Allgemeine API</span><span class="sxs-lookup"><span data-stu-id="34400-125">Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="34400-126">[Custom-Functions-Runtime/Index. d. TS](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (die CLR-Definitionen für benutzerdefinierte Excel-Funktionen)</span><span class="sxs-lookup"><span data-stu-id="34400-126">[custom-functions-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (The Excel Custom Functions runtime definitions.)</span></span>
  - [<span data-ttu-id="34400-127">Benutzerdefinierte Funktionen</span><span class="sxs-lookup"><span data-stu-id="34400-127">Custom Functions</span></span>](https://docs.microsoft.com/javascript/api/custom-functions-runtime)
- <span data-ttu-id="34400-128">[Office-Runtime/Index. d. TS](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (die Office-Lauf Zeitdefinitionen für die Plattform für benutzerdefinierte Funktionen)</span><span class="sxs-lookup"><span data-stu-id="34400-128">[office-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (The office runtime definitions for the Custom Functions platform.)</span></span>
  - [<span data-ttu-id="34400-129">Office-Laufzeit</span><span class="sxs-lookup"><span data-stu-id="34400-129">Office Runtime</span></span>](https://docs.microsoft.com/javascript/api/office-runtime)

<span data-ttu-id="34400-130">Ältere Versionen der APIs haben eigene d. TS-Dateien.</span><span class="sxs-lookup"><span data-stu-id="34400-130">Older versions of the APIs have their own d.ts files.</span></span> <span data-ttu-id="34400-131">Diese werden beibehalten, wenn ein neuer API-Anforderungs Satzes freigegeben wird.</span><span class="sxs-lookup"><span data-stu-id="34400-131">These are preserved when a new API requirement set is released.</span></span> <span data-ttu-id="34400-132">Sie können auch mithilfe des [Version Remover-Tools](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts)generiert werden.</span><span class="sxs-lookup"><span data-stu-id="34400-132">They can also be generated using the [Version Remover tool](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span></span> <span data-ttu-id="34400-133">Diese alten d. TS-Dateien werden beibehalten, sodass im Ereignis-APIs gepatcht oder geändert werden, das ursprüngliche Verhalten ist weiterhin dokumentiert.</span><span class="sxs-lookup"><span data-stu-id="34400-133">These old d.ts files are maintained so that in the event APIs are patched or altered, the original behavior is still documented.</span></span> <span data-ttu-id="34400-134">Dies ist hilfreich, wenn Sie eine ältere Version der API als Ziel haben.</span><span class="sxs-lookup"><span data-stu-id="34400-134">This is useful if you have to target an older version of the API.</span></span>

#### <a name="testing-type-definition-file-changes"></a><span data-ttu-id="34400-135">Testen von Änderungen an der Typen Definitionsdatei</span><span class="sxs-lookup"><span data-stu-id="34400-135">Testing type definition file changes</span></span>

<span data-ttu-id="34400-136">Alle Änderungen an der Dokumentation für die Office-JavaScript-API werden durch Bearbeiten der oben erwähnten vier d. TS-Dateien vorgenommen.</span><span class="sxs-lookup"><span data-stu-id="34400-136">Any documentation changes for the Office JavaScript API are done by editing the four d.ts files mentioned above.</span></span> <span data-ttu-id="34400-137">Sie können jedoch eine Änderung testen, bevor Sie eine PR an DefinitelyTyped übermitteln (wenn Sie beispielsweise testen möchten, wie ihre Formatierung in ein Abschlag übersetzt wird), indem Sie die entsprechende Datei in [generieren-docs/Script-Inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) bearbeiten und [GenerateDocs. cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd)ausführen.</span><span class="sxs-lookup"><span data-stu-id="34400-137">However, you can test a change before submitting a PR to DefinitelyTyped (if you need to, for example, test how your formatting will translate into markdown) by editing the corresponding file in [generate-docs/script-inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) and running [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd).</span></span> <span data-ttu-id="34400-138">Wenn Sie dazu aufgefordert werden, wählen Sie die Option "lokale Dateien" aus.</span><span class="sxs-lookup"><span data-stu-id="34400-138">When prompted, select the "Local files" option.</span></span>

<span data-ttu-id="34400-139">Durch das Pushen von Änderungen an einem Remote Zweig dieses Repo wird die docs.Microsoft.com-Plattform zum Erstellen einer Test Verzweigung veranlasst.</span><span class="sxs-lookup"><span data-stu-id="34400-139">Pushing changes to a remote branch of this repo causes the docs.microsoft.com platform to build a test branch.</span></span> <span data-ttu-id="34400-140">Diese Verzweigung wird auf review.docs.Microsoft.com gerendert, auf die nur interne Microsoft-Mitarbeiter zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="34400-140">This branch is rendered on review.docs.microsoft.com, which is only accessible by internal Microsoft personnel.</span></span> <span data-ttu-id="34400-141">Jeder, der Ihre PR überprüft, überprüft die Website überprüfen auf Richtigkeit.</span><span class="sxs-lookup"><span data-stu-id="34400-141">Anyone reviewing your PR will check the review site for accuracy.</span></span>

### <a name="code-snippets"></a><span data-ttu-id="34400-142">Codeausschnitte</span><span class="sxs-lookup"><span data-stu-id="34400-142">Code snippets</span></span>

<span data-ttu-id="34400-143">Code Beispiel Ausschnitte werden den Verweisseiten aus zwei Quellen hinzugefügt:</span><span class="sxs-lookup"><span data-stu-id="34400-143">Code example snippets are added to the reference pages from two sources:</span></span>

- [<span data-ttu-id="34400-144">Skript laborbeispiele</span><span class="sxs-lookup"><span data-stu-id="34400-144">Script Lab Samples</span></span>](https://github.com/OfficeDev/office-js-snippets)
- [<span data-ttu-id="34400-145">Lokale Code Ausschnitte</span><span class="sxs-lookup"><span data-stu-id="34400-145">Local Code Snippets</span></span>](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/code-snippets)

<span data-ttu-id="34400-146">Die lokalen Codeausschnitte befinden sich in hostspezifischen YAML-Dateien.</span><span class="sxs-lookup"><span data-stu-id="34400-146">The local snippets are in host-specific yaml files.</span></span> <span data-ttu-id="34400-147">Ihr Inhalt ist nach Klasse und Feld organisiert, sodass er der entsprechenden Stelle in einer Referenzseite zugeordnet werden kann.</span><span class="sxs-lookup"><span data-stu-id="34400-147">Their content is organized by class and field, so it can be mapped to the appropriate place in a reference page.</span></span> <span data-ttu-id="34400-148">Die Sprache des Codeausschnitts (JavaScript oder Manuskript) wird durch die Verwendung von await-Anweisungen hergeleitet.</span><span class="sxs-lookup"><span data-stu-id="34400-148">The language of the snippet (JavaScript or TypeScript) is inferred by the use of await statements.</span></span>

<span data-ttu-id="34400-149">Die Skript Labor Codeausschnitte werden aus Arbeitsbeispielen abgerufen.</span><span class="sxs-lookup"><span data-stu-id="34400-149">The Script Lab snippets are pulled from working samples.</span></span> <span data-ttu-id="34400-150">Derzeit werden Excel-, Outlook-und Word-Beispiele den Referenzdokumenten Abschnitten durch [Zuordnungsdateien](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata)zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="34400-150">Currently, Excel, Outlook, and Word samples are mapped to reference document sections through [mapping files](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata).</span></span> <span data-ttu-id="34400-151">Diese stimmen mit einzelnen Beispiel Methoden mit Eigenschaften oder Methoden in der API überein.</span><span class="sxs-lookup"><span data-stu-id="34400-151">These match individual sample methods to properties or methods in the API.</span></span> <span data-ttu-id="34400-152">Beim Ausführen des Office-js-Snippets-Repositorys `yarn start` wird [eine YAML-Datei](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml) erstellt, die alle zugeordneten Codeausschnitte enthält.</span><span class="sxs-lookup"><span data-stu-id="34400-152">When the office-js-snippets repository's `yarn start` runs, [a yaml file](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml) containing all the mapped snippets is created.</span></span> <span data-ttu-id="34400-153">Diese YAML-Datei ist die Eingabe in das Referenz Dokumentationstool.</span><span class="sxs-lookup"><span data-stu-id="34400-153">This yaml file is the input into the reference documentation tooling.</span></span>

## <a name="tooling-pipeline"></a><span data-ttu-id="34400-154">Tooling-Pipeline</span><span class="sxs-lookup"><span data-stu-id="34400-154">Tooling pipeline</span></span>

![Ein Bild, das die Ablaufsteuerung von eindeutig typisiert, an den Präprozessor, den API-Extraktionsprozess, den Präprozessor, den API-Dokumenter und bis zum Postprocessor zeigt.](ToolingPipeline.png)

<span data-ttu-id="34400-156">Zwischen den Inhaltsquellen und den letzten Seiten werden im Dokumentations Inhalt fünf Tools beschrieben:</span><span class="sxs-lookup"><span data-stu-id="34400-156">Between the content sources and the final pages, the documentation content goes through five tooling steps:</span></span>

1. [<span data-ttu-id="34400-157">Präprozessor-Skript</span><span class="sxs-lookup"><span data-stu-id="34400-157">Preprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/preprocessor.ts)
1. [<span data-ttu-id="34400-158">API-Extraktion</span><span class="sxs-lookup"><span data-stu-id="34400-158">API Extractor</span></span>](https://api-extractor.com/)
1. [<span data-ttu-id="34400-159">Präprozessor-Skript</span><span class="sxs-lookup"><span data-stu-id="34400-159">Midprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/midprocessor.ts)
1. [<span data-ttu-id="34400-160">API-Dokumentation</span><span class="sxs-lookup"><span data-stu-id="34400-160">API Documenter</span></span>](https://github.com/microsoft/rushstack/blob/master/apps/api-documenter/README.md)
1. [<span data-ttu-id="34400-161">Postprocessor-Skript</span><span class="sxs-lookup"><span data-stu-id="34400-161">Postprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/postprocessor.ts)

<span data-ttu-id="34400-162">Der Präprozessor verwendet die d. TS-Dateien und teilt Sie in hostspezifische Abschnitte auf.</span><span class="sxs-lookup"><span data-stu-id="34400-162">The preprocessor takes the d.ts files and splits them into host-specific sections.</span></span> <span data-ttu-id="34400-163">Sie führt alle erforderlichen Aufräumvorgänge aus, damit die nachfolgenden Tools die Daten ordnungsgemäß verarbeiten können.</span><span class="sxs-lookup"><span data-stu-id="34400-163">It performs any cleanup necessary for the subsequent tools to properly process the data.</span></span>

<span data-ttu-id="34400-164">API Extractor konvertiert die d. TS-Dateien in JSON-Daten.</span><span class="sxs-lookup"><span data-stu-id="34400-164">API Extractor converts the d.ts files into JSON data.</span></span> <span data-ttu-id="34400-165">Dadurch werden alle Typdaten löst, sodass eine einfachere Analyse möglich ist.</span><span class="sxs-lookup"><span data-stu-id="34400-165">This tokenizes all the type data, allowing for easier parsing.</span></span>

<span data-ttu-id="34400-166">Der Mittel Prozessor Ruft die Codeausschnitte ab und verbindet Sie mit den richtigen Hosts und bereinigt die Vernetzung zwischen Outlook und Common API-Objekten.</span><span class="sxs-lookup"><span data-stu-id="34400-166">The midprocessor retrieves the code snippets and pairs them with the proper hosts, and cleans up the crosslinking between Outlook and Common API objects.</span></span>

<span data-ttu-id="34400-167">API-Dokumentierer wandelt die JSON-Daten in yml-Dateien um.</span><span class="sxs-lookup"><span data-stu-id="34400-167">API Documenter converts the JSON data into .yml files.</span></span> <span data-ttu-id="34400-168">Die yml-Dateien werden vom geöffneten Veröffentlichungs System, das unsere Dokumente in docs.Microsoft.com veröffentlicht, in einen Abschlag umgewandelt.</span><span class="sxs-lookup"><span data-stu-id="34400-168">The .yml files are converted to markdown by the Open Publishing System that publishes our docs to docs.microsoft.com.</span></span> <span data-ttu-id="34400-169">API-Dokumentierer enthält auch eine Office-spezifische Erweiterung, die unsere Codeausschnitte einfügt.</span><span class="sxs-lookup"><span data-stu-id="34400-169">API Documenter also contains an Office-specific extension that inserts our code snippets.</span></span>

<span data-ttu-id="34400-170">Der postprocesser bereinigt das Inhaltsverzeichnis und verschiebt die yml-Dateien in den [Veröffentlichungsordner](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span><span class="sxs-lookup"><span data-stu-id="34400-170">The postprocessor cleans up the table of contents and moves the .yml files into the [publishing folder](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span></span>

<span data-ttu-id="34400-171">Alle fünf Schritte werden ausgeführt, wenn [GenerateDocs. cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="34400-171">All five of these steps are performed when [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) is run.</span></span> <span data-ttu-id="34400-172">Dieses Skript verarbeitet auch die Installation von Knoten Modulen, bereinigt alte Dateisätze und typdefinitions Dateien für Versionstypen für jeden Anforderungssatz.</span><span class="sxs-lookup"><span data-stu-id="34400-172">That script also handles node module installation, cleans out old file sets, and versions Type Definition files for each requirement set.</span></span>
